<% if notice %>
  <p class="notice-message"><%= notice %></p>
<% end %>

<% content_for :title, "Invoices" %>

<!-- Dashboard de Resumo das Faturas -->
<div class="dashboard-summary">
  <div class="summary-card">
    <h3>Total de Faturas</h3>
    <p><%= number_to_currency(@total_invoices_amount, unit: "R$", separator: ",", delimiter: ".", format: "%u %n") %></p>
  </div>

  <div class="summary-card">
    <h3>Faturas Pagas</h3>
    <p><%= number_to_currency(@paid_invoices_amount, unit: "R$", separator: ",", delimiter: ".", format: "%u %n") %></p>
  </div>

  <div class="summary-card">
    <h3>Faturas a Receber</h3>
    <p><%= number_to_currency(@pending_invoices_amount, unit: "R$", separator: ",", delimiter: ".", format: "%u %n") %></p>
  </div>

  <div class="summary-card">
    <h3>Faturas Vencidas</h3>
    <p><%= number_to_currency(@overdue_invoices_amount, unit: "R$", separator: ",", delimiter: ".", format: "%u %n") %></p>
  </div>
</div>

<h1 class="page-title">Invoices</h1>

<!-- Tabela de Faturas -->
<table class="table table-striped">
  <thead>
    <tr>
      <th>#</th>
      <th>Cliente</th>
      <th>Paga?</th>
      <th>Valor</th>
      <th>Vencimento</th>
      <th>Ações</th>
    </tr>
  </thead>
  <tbody>
    <% @invoices.each do |invoice| %>
      <tr>
        <td><%= invoice.id %></td>
        <td><%= invoice.subscription.contract.customer.name %></td> <!-- Mostrar o nome do cliente -->
        <td>
          <%= invoice.paid? ? "Sim" : "Não" %> <!-- Exibe 'Sim' ou 'Não' com base no status de pagamento -->
        </td>
        <td><%= number_to_currency(invoice.amount, unit: "R$", separator: ",", delimiter: ".", format: "%u %n") %></td>
        <td><%= invoice.due_date.strftime("%d/%m/%Y") %></td> <!-- Formatar a data de vencimento -->
        <td>
          <%= link_to "Ver", invoice, class: "btn btn-link" %>
          <%= link_to "Editar", edit_invoice_path(invoice), class: "btn btn-link" %>
          <%= link_to "Excluir", invoice, method: :delete, data: { confirm: "Certeza?" }, class: "btn btn-link" %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<!-- Paginação -->
<div class="pagination">
  <%= will_paginate @invoices %> <!-- Paginação com o gem will_paginate -->
</div>

<!-- Link para criar nova fatura -->
<div class="new-invoice-link">
  <%= link_to "New invoice", new_invoice_path, class: "btn btn-custom" %>
</div>

<!-- Estilos -->
<style>

  /* Estilo para a mensagem de sucesso */
  .notice-message {
    color: #28a745;
    background-color: #d4edda;
    font-size: 1rem;
    padding: 10px;
    border-radius: 5px;
    margin-bottom: 20px;
    text-align: center;
  }

  /* Estilo do título */
  .page-title {
    font-size: 1.8rem;
    font-weight: bold;
    color: #333;
    text-align: center;
    margin-bottom: 20px;
  }

  /* Estilo do painel de resumo */
  .dashboard-summary {
    display: grid;
    grid-template-columns: 1fr;
    gap: 20px;
    padding: 20px;
    margin-bottom: 20px;
  }

  .summary-card {
    background-color: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    text-align: center;
  }

  .summary-card h3 {
    font-size: 1.2rem;
    color: #333;
    margin-bottom: 10px;
  }

  .summary-card p {
    font-size: 1.5rem;
    font-weight: bold;
    color: #007bff;
  }

  /* Estilo da tabela de faturas */
  .table {
    width: 100%;
    margin-top: 20px;
  }

  /* Estilo das células da tabela */
  .table th, .table td {
    padding: 12px;
    text-align: center;
  }

  /* Estilo do link de mostrar a fatura */
  .btn-link {
    color: #007bff;
    font-size: 1rem;
    font-weight: bold;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .btn-link:hover {
    color: #0056b3;
    text-decoration: underline;
  }

  /* Estilo do botão de novo */
  .new-invoice-link {
    text-align: center;
    margin-top: 30px;
  }

  .btn-custom {
    background-color: #333;
    color: white;
    font-size: 1rem;
    padding: 10px 20px;
    border-radius: 5px;
    border: none;
    text-decoration: none;
    display: inline-block;
    transition: background-color 0.3s ease;
  }

  .btn-custom:hover {
    background-color: #555;
  }

  /* Estilos responsivos para telas maiores */
  @media (min-width: 768px) {
    .dashboard-summary {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 1024px) {
    .dashboard-summary {
      grid-template-columns: repeat(4, 1fr);
    }
  }
</style>
